(()=>{"use strict";var e={424:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(s,i){function r(e){try{a(o.next(e))}catch(e){i(e)}}function l(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,l)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendAndReceiveMessage=t.captureResponse=t.simulateInput=void 0;const s=n(283),i=n(84),r=n(327);function l(e,t){const n=t||document,o=n.querySelector('div[contenteditable="true"]');if(o)return(0,s.setSentMessage)(e),o.innerHTML=e,o.focus(),void a(o);const i=n.querySelector('input[type="text"], textarea');if(i)return(0,s.setSentMessage)(e),i.focus(),i.value=e,void a(i);console.error("Input field or rich text editor not found.")}function a(e){const t=new Event("input",{bubbles:!0});e.dispatchEvent(t);const n=new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:"Enter",code:"Enter",keyCode:13});e.dispatchEvent(n)}function c(e,t,n=2e4){return o(this,void 0,void 0,(function*(){const l=Date.now(),a=window.location.href,c=new URL(a).origin,u=i.ChatPlatformSelectors[c];if(!t&&!u)throw new Error("Invalid website specified and no chatbot element provided");const d=t||document,m=Array.from(d.querySelectorAll(u||"*"));let f="",h=Date.now();console.log(d);const p=()=>o(this,void 0,void 0,(function*(){const t=Date.now(),o=Array.from(d.querySelectorAll(u||"*")).filter((e=>{var t;return!(null===(t=e.textContent)||void 0===t?void 0:t.includes((0,s.getSentMessage)()))&&!m.includes(e)})).map((e=>{var t;return(null===(t=e.textContent)||void 0===t?void 0:t.trim())||""})).filter((e=>function(e){return r.commonChatbotPhrases.some((t=>e.includes(t)))||/^[A-Z]/.test(e)||e.endsWith("?")||e.length>20}(e)));if(o.length>0){const n=o[o.length-1];n.length>f.length?(f=n,h=t,yield new Promise((e=>setTimeout(e,500))),yield p()):t-h<5e3?(yield new Promise((e=>setTimeout(e,500))),yield p()):(console.log("Final response:",f),f&&(s.responses[e]=f))}else t-l<n?(yield new Promise((e=>setTimeout(e,500))),yield p()):console.error("Response not found within the max wait time.")}));return yield new Promise((e=>setTimeout(e,2e3))),yield p(),{message:e,response:f}}))}t.simulateInput=l,t.captureResponse=c,t.sendAndReceiveMessage=function(e,t){return o(this,void 0,void 0,(function*(){return l(e,t),yield c(e,t)}))}},283:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(s,i){function r(e){try{a(o.next(e))}catch(e){i(e)}}function l(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,l)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.setSentMessage=t.getSentMessage=t.responses=void 0;const s=n(424),i=n(311);t.responses={};let r="";t.getSentMessage=function(){return r},t.setSentMessage=function(e){r=e},chrome.runtime.onMessage.addListener(((e,t,n)=>o(void 0,void 0,void 0,(function*(){if("typeMessages"===e.action){const t=(0,i.getStoredChatbotElement)();let o=[];for(let n=0;n<e.messages.length;n++){const i=e.messages[n];let r;r=t?yield(0,s.sendAndReceiveMessage)(i,t):yield(0,s.sendAndReceiveMessage)(i),o.push(r),n<e.messages.length-1&&(yield new Promise((e=>setTimeout(e,2e3))))}console.log(o),n({status:"Messages typed and responses received",responses:o})}else"startSelection"===e.action?i.elementSelector.startSelection():console.error("Unknown action:",e.action)}))))},311:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.elementSelector=t.getStoredChatbotElement=t.startSelection=void 0;const o=n(771);let s=!1,i=null,r=[],l=null,a=null;function c(){s=!0,l=document.createElement("div"),l.style.position="fixed",l.style.pointerEvents="none",l.style.zIndex="9999",l.style.border="2px solid red",l.style.backgroundColor="rgba(0, 0, 0, 0.3)",document.body.appendChild(l),document.body.style.setProperty("cursor","crosshair","important"),document.addEventListener("mousemove",u),document.addEventListener("click",d),(0,o.showMessage)("Click on a part of the chatbot. You may need to click multiple times to identify the entire chatbot.")}function u(e){if(s&&l){e.preventDefault(),e.stopPropagation();const t=document.elementFromPoint(e.clientX,e.clientY);t&&t!==i&&function(e){if(i=e,l){const t=e.getBoundingClientRect();l.style.left=`${t.left}px`,l.style.top=`${t.top}px`,l.style.width=`${t.width}px`,l.style.height=`${t.height}px`}}(t)}}function d(e){if(s){e.preventDefault(),e.stopPropagation();const t=e.target;if(t){r.push(t);const e=function(e){const t=[m,f,h].map((t=>t(e))).filter((e=>null!==e));return t.length>=2?t[0]:null}(t);if(e)g(e);else if(r.length>=3){const e=function(){if(r.length<2)return null;let e=r[0];for(let t=1;t<r.length;t++)e=p(e,r[t]);return e}();e?g(e):(0,o.showMessage)("Couldn't identify chatbot element. Please try clicking on a different part of the chatbot.")}else(0,o.showMessage)("Couldn't identify chatbot element yet. Please try clicking on a different part of the chatbot.")}}}function m(e){const t=e.getBoundingClientRect();let n=e.parentElement;for(;n;){const e=n.getBoundingClientRect();if(e.width*e.height/(t.width*t.height)>2){const e=n.children;let t=0;for(const n of Array.from(e))n.matches('input[type="text"], textarea, .messages, .chat-messages, button[type="submit"], .send-button')&&t++;if(t>=2)return n}n=n.parentElement}return null}function f(e){let t=e;const n=['input[type="text"]',"textarea",".messages, .chat-messages",'button[type="submit"], .send-button',".chat-header, .chat-title",".user-avatar, .chat-avatar",".typing-indicator, .typing-dots"];for(;t&&t!==document.body;){let e=0;for(const o of n)t.querySelector(o)&&e++;if(e>=2)return t;t=t.parentElement}return null}function h(e){let t=e,n=0;for(;t&&t!==document.body&&n<5;){const e=(t.className+" "+t.id).toLowerCase();if(["chat","bot","message","conversation","dialogue"].some((t=>e.includes(t)))){const e=t.children.length>3,n=(t.textContent||"").length>100;if(e&&n)return t}t=t.parentElement,n++}return null}function p(e,t){const n=y(e),o=y(t);for(const e of n)if(o.includes(e))return e;return document.body}function y(e){const t=[];let n=e;for(;n&&n!==document.body;)t.push(n),n=n.parentElement;return t}function g(e){a=e;const t=e.outerHTML;console.log(e),function(e){const t=e.getBoundingClientRect(),n=document.createElement("div");n.style.position="fixed",n.style.pointerEvents="none",n.style.zIndex="10000",n.style.left=`${t.left}px`,n.style.top=`${t.top}px`,n.style.width=`${t.width}px`,n.style.height=`${t.height}px`,n.style.backgroundColor="rgba(0, 255, 0, 0.5)",n.style.transition="opacity 0.5s ease-in-out",n.style.opacity="1",document.body.appendChild(n),setTimeout((()=>{n.style.opacity="0",setTimeout((()=>{document.body.removeChild(n)}),1e3)}),1e3)}(e),chrome.runtime.sendMessage({action:"storeHTML",html:t},(()=>{(0,o.showMessage)("Chatbot element identified and HTML stored!")})),v()}function v(){s=!1,document.body.style.removeProperty("cursor"),document.removeEventListener("mousemove",u),document.removeEventListener("click",d),l&&(document.body.removeChild(l),l=null),i=null,r=[]}t.startSelection=c,t.getStoredChatbotElement=function(){return a},t.elementSelector={startSelection:c,resetSelection:v}},327:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.commonChatbotPhrases=void 0,t.commonChatbotPhrases=["Hello","Hi","Welcome","How can I help you?","Is there anything else I can assist you with?","Thank you for contacting us","I'm sorry, I didn't understand that","Please rephrase your question","Is there anything else you'd like to know?","Chat started at","Conversation ended","Olá","Oi","Bem-vindo","Em que posso ajudar?","Posso ajudar com mais alguma coisa?","Obrigado por nos contactar","Desculpe, não entendi","Por favor, reformule sua pergunta","Há mais alguma coisa que gostaria de saber?","Conversa iniciada às","Tempo limite de espera atingido"]},771:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.showMessage=void 0,t.showMessage=function(e){const t=document.createElement("div");t.style.position="fixed",t.style.top="10px",t.style.left="50%",t.style.transform="translateX(-50%)",t.style.backgroundColor="rgba(0, 0, 0, 0.7)",t.style.color="white",t.style.padding="10px",t.style.borderRadius="5px",t.style.zIndex="10000",t.textContent=e,document.body.appendChild(t),setTimeout((()=>{document.body.removeChild(t)}),3e3)}},84:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ChatPlatformSelectors=void 0,t.ChatPlatformSelectors={"https://chatgpt.com":"div.agent-turn","https://claude.ai":"div.font-claude-message","https://gemini.google.com":"message-content.model-response-text"}}},t={};!function n(o){var s=t[o];if(void 0!==s)return s.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}(283)})();